<!DOCTYPE html>
<html>
  <head>
      <title>Planets and Pirates</title> 
    <script src="jspsych-6.1.0/jspsych.js"></script>
      <link href="jspsych-6.1.0/css/jspsych.css" rel="stylesheet" type="text/css"></link>
    <script src="jspsych-6.1.0/plugins/jspsych-fullscreen.js"></script>
      <script src="jspsych-6.1.0/plugins/jspsych-html-button-response.js"></script>
    <script src="jspsych-6.1.0/plugins/jspsych-survey-html-form.js"></script>
    <script src="jspsych-6.1.0/plugins/jspsych-instructions.js"></script>
    <script src="jspsych-6.1.0/plugins/jspsych-survey-multi-choice.js"></script>
    <script src="jspsych-6.1.0/plugins/jspsych-survey-multi-catch.js"></script>
      <script src="jspsych-6.1.0/plugins/jspsych-image-keyboard-response.js"></script>
      <script src="jspsych-6.1.0/plugins/planet-response.js"></script>
      <script src="jspsych-6.1.0/plugins/jspsych-inference-check-1.js"></script>
      <script src="jspsych-6.1.0/plugins/jspsych-inference-check-4.js"></script>
      <script src="jspsych-6.1.0/plugins/jspsych-inference-check-5.js"></script>
      <script src="jspsych-6.1.0/plugins/jspsych-valence-check-3.js"></script>
      <script src="jspsych-6.1.0/plugins/jspsych-valence-check-4.js"></script>
    <script src="jspsych-6.1.0/plugins/jspsych-valence-check-5.js"></script>
    <script src="jspsych-6.1.0/plugins/jspsych-valence-check-6.js"></script>
    <script src="jspsych-6.1.0/plugins/jspsych-valence-check-8.js"></script>
    <script src="jspsych-6.1.0/plugins/jspsych-html-slider-triangle.js"></script>

    <script src="jspsych-6.1.0/plugins/jspsych-survey-likert.js"></script>
    <script src="jspsych-6.1.0/plugins/jspsych-survey-likert-catch.js"></script>

    <script src="jspsych-6.1.0/plugins/jspsych-survey-text.js"></script>
    <script src="jspsych-6.1.0/plugins/jspsych-html-slider-response.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/paper.js/0.12.15/paper-full.min.js"></script>

  
    <head>

    </head>

<!-- 

    <script src="text.js"></script>
    <script src="app2.js"></script> -->
    

    
  </head>
  <body>
     
    <script>

----------------------------------------------------------------------
// Experiment Parameters
//----------------------------------------------------------------------------
  Randomises the participant's group and sample. Also sets up the randomised
  position of the punished planet, left-right assignment of planets and ships,
  global variables, and the images list.  */
// Text/string based variables are imported through text.js via the global scope.

// Participant Sample Selection
let groups = ["early_0.1", "early_0.4", "late_0.1", "late_0.4"];
let group = jsPsych.randomization.sampleWithReplacement(groups, 1);
let samples = ["ProA", "others"];
let sample = samples[0];  

// randomise position of planets (left/middle/right as 0/1/2)
let num_planets = 3;
let planet_sides = [...Array(num_planets).keys()].map(x => x.toString());
let planet_side = jsPsych.randomization.sampleWithReplacement(planet_sides, 1)[0];
// Stimulus and image Initialization
const stim_list = jsPsych.randomization.repeat(['img/planet_p.png','img/planet_o.png', 'img/planet_b.png'], 1);
const ship_list = jsPsych.randomization.repeat(['img/ship1.png','img/ship2.png','img/ship3.png'], 1);
const stim_selector_highlight = 'img/selectring.png';
const images = [
  'img/signal1.png','img/signal2.png','img/signal3.png','img/signal4.png',
  'img/ship1.png','img/ship2.png', 'img/planet_p.png',
  'img/planet_b.png','img/planet_o.png',
  'img/cursor.png','img/cursordark.png', 'img/selectring.png',
  'img/win100.png', 'img/lose.png',
  'img/arrow.jpg', 'img/blank_lose.jpg', 'img/blank_arrow.jpg'
];
const planetColors = {
  'img/planet_p.png': 'pink',
  'img/planet_o.png': 'orange',
  'img/planet_b.png': 'blue',
};


// Global Variables Definition
let block_number = 0;
let trial_number = 0;
let points = 0;
const block_duration = 180 * 100; // in milliseconds (3 mins)
const iti = 1000;
const inf_stim_height = 80;
const inf_slider_width = 500;
const main_stim_height = 250;
const feedback_duration = 2500;
const rf_ship_delay = 1500;
const probability_trade = [[.5], [.5], [.5]];
const probability_shield = [[.5], [.5], [.5]];
const reset_planet_wait_const = 1000;
const shield_charging_time_const = 3000;
const ship_attack_time_const = 6000;
const nBlocks_p1 = 1;
let nBlocks_p2 = 1;
let nBlocks_p3 = 1;
//let ship_attack_damage_index = [0(non-attack), fixed 100pts,25%]
let planet_labels = ['Planet A','Planet B','Planet C'];
let ship_attack_damage = [0, 100, 0.2];


// manipulate response-ship Rft rate
if (group[0].includes("0.1")) {
  var probability_ship = [[0.1],[0.1],[0.1]]; 
} else if (group[0].includes("0.4")) {
  var probability_ship = [[0.4],[0.4],[0.4]];
} else (console.error("ERROR: group is not defined as 0.1 or 0.4"))

var probability_ship = [[1],[1],[1]]; 

// // manipulate early/late instruction by block sizes of phase 2/3
// if (group[0].includes("early")) {
//   nBlocks_p2 = 2;
//   nBlocks_p3 = 3;
// } else if (group[0].includes("late")) {
//   nBlocks_p2 = 3;
//   nBlocks_p3 = 4;
// } else (console.log("ERROR: group is not defined as early or late"))


// var probability_ship = probability_ship;
//Continious or discreete testing phases
let continuousResp = true;
let nTrialspBlk = 5; //if continuousResp is true though, this doesnt matter
if (continuousResp){
    let nTrialspBlk = 1;
}




var i = 1;
// Question 3
var p1_q3_triangle = {
  type: 'html-slider-triangle',
  prompt: "Reflecting back on what you did in the <b>most recent block</b>, <p>what proportion of your recent interactions were with each planet:",
  stimulus_left: stim_list[0],
  stimulus_right: stim_list[1],
  stimulus_bottom: stim_list[2],
  stimulus_all: stim_list,
  planetColors: planetColors,
  stimulus_height: 250,
  slider_width: 900, // Increased width to accommodate more space for labels
  labels: ["100%/0%/0%<p>(only click Planet A)</p>", "66%/33%/0%", "50%/50%/0%<p>(click all equally)</p>", "33%/66%/0%", "0%/100%/0%<p>(only click Planet B)</p>", "0%/0%/100%<p>(only click Planet C)</p>"],
  require_movement: false,
  data: {
    phase: 'slider-response_p1_q3',
    block_number: i + nBlocks_p1,
  }
};

    
        let timeline = [];
    
        jsPsych.run(timeline);
        timeline.push(p1_q3_triangle);
      </script>

  </body>
</html> 